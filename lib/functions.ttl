# baseURI: https://architecture.politie.nl/metromap/functions
# imports: http://simplearchimatemodel.politie.nl/
# imports: http://spinrdf.org/spinx
# imports: http://spinrdf.org/spl
# imports: http://www.opengroup.org/xsd/archimate/3.0/
# prefix: functions

@prefix functions: <https://architecture.politie.nl/metromap/functions#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sam: <http://simplearchimatemodel.politie.nl/> .
@prefix sp: <http://spinrdf.org/sp#> .
@prefix spin: <http://spinrdf.org/spin#> .
@prefix spinx: <http://spinrdf.org/spinx#> .
@prefix spl: <http://spinrdf.org/spl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

<https://architecture.politie.nl/metromap/functions>
  a owl:Ontology ;
  owl:imports sam: ;
  owl:imports <http://spinrdf.org/spinx> ;
  owl:imports <http://spinrdf.org/spl> ;
  owl:imports <http://www.opengroup.org/xsd/archimate/3.0/> ;
.
functions:connectedElement
  a spin:MagicProperty ;
  spin:body [
      a sp:Select ;
      sp:resultVariables (
          [
            sp:varName "source" ;
          ]
        ) ;
      sp:where (
          [
            sp:object [
                sp:varName "targetId" ;
              ] ;
            sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/target> ;
            sp:subject [
                sp:varName "connection" ;
              ] ;
          ]
          [
            sp:object [
                sp:varName "sourceConnectionId" ;
              ] ;
            sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/source> ;
            sp:subject [
                sp:varName "connection" ;
              ] ;
          ]
          [
            a sp:Filter ;
            sp:expression [
                a sp:eq ;
                sp:arg1 spin:_arg1 ;
                sp:arg2 [
                    sp:varName "targetId" ;
                  ] ;
              ] ;
          ]
          [
            sp:object [
                sp:varName "sourceConnectionId" ;
              ] ;
            sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/identifier> ;
            sp:subject [
                sp:varName "source" ;
              ] ;
          ]
        ) ;
    ] ;
  spin:constraint [
      a spl:Argument ;
      spl:predicate sp:arg1 ;
    ] ;
  rdfs:label "connected element" ;
  rdfs:subClassOf spin:select ;
.
functions:getColor
  a spin:Function ;
  spin:constraint [
      a spl:Argument ;
      spl:predicate sp:arg1 ;
      spl:valueType xsd:string ;
    ] ;
  spin:returnType xsd:string ;
  spinx:javaScriptFile "randomcolor.js" ;
  rdfs:label "get color" ;
  rdfs:subClassOf spin:Functions ;
.
functions:getStyle
  a spin:Function ;
  spin:body [
      a sp:Select ;
      sp:resultVariables (
          [
            sp:varName "style" ;
          ]
          spin:_arg1
        ) ;
      sp:where (
          [
            sp:object sam:SBB ;
            sp:predicate rdf:type ;
            sp:subject spin:_arg1 ;
          ]
          [
            a sp:Optional ;
            sp:elements (
                [
                  sp:object <http://www.opengroup.org/xsd/archimate/3.0/Aggregation> ;
                  sp:predicate rdf:type ;
                  sp:subject [
                      sp:varName "aggregation" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "aggregationSource" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/source> ;
                  sp:subject [
                      sp:varName "aggregation" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "aggregationSource" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/identifier> ;
                  sp:subject [
                      sp:varName "plateau" ;
                    ] ;
                ]
                [
                  sp:object <http://www.opengroup.org/xsd/archimate/3.0/Plateau> ;
                  sp:predicate rdf:type ;
                  sp:subject [
                      sp:varName "plateau" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "aggregationTarget" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/target> ;
                  sp:subject [
                      sp:varName "aggregation" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "aggregationTarget" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/identifier> ;
                  sp:subject [
                      sp:varName "assignment" ;
                    ] ;
                ]
                [
                  sp:object <http://www.opengroup.org/xsd/archimate/3.0/Assignment> ;
                  sp:predicate rdf:type ;
                  sp:subject [
                      sp:varName "assignment" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "assignmentSource" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/source> ;
                  sp:subject [
                      sp:varName "assignment" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "assignmentSource" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/identifier> ;
                  sp:subject [
                      sp:varName "application" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "assignmentTarget" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/target> ;
                  sp:subject [
                      sp:varName "assignment" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "assignmentTarget" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/identifier> ;
                  sp:subject [
                      sp:varName "function" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "service" ;
                    ] ;
                  sp:predicate sam:R ;
                  sp:subject [
                      sp:varName "function" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "application" ;
                    ] ;
                  sp:predicate sam:A ;
                  sp:subject spin:_arg1 ;
                ]
              ) ;
          ]
          [
            a sp:Optional ;
            sp:elements (
                [
                  sp:object <http://www.opengroup.org/xsd/archimate/3.0/Association> ;
                  sp:predicate rdf:type ;
                  sp:subject [
                      sp:varName "association" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "associationSource" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/source> ;
                  sp:subject [
                      sp:varName "association" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "associationTarget" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/target> ;
                  sp:subject [
                      sp:varName "association" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "associationSource" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/identifier> ;
                  sp:subject [
                      sp:varName "plateau" ;
                    ] ;
                ]
                [
                  sp:object <http://www.opengroup.org/xsd/archimate/3.0/Plateau> ;
                  sp:predicate rdf:type ;
                  sp:subject [
                      sp:varName "plateau" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "associationTarget" ;
                    ] ;
                  sp:predicate <http://www.opengroup.org/xsd/archimate/3.0/identifier> ;
                  sp:subject [
                      sp:varName "application" ;
                    ] ;
                ]
                [
                  sp:object [
                      sp:varName "application" ;
                    ] ;
                  sp:predicate sam:A ;
                  sp:subject spin:_arg1 ;
                ]
              ) ;
          ]
          [
            sp:object [
                sp:varName "abb" ;
              ] ;
            sp:predicate sam:R ;
            sp:subject spin:_arg1 ;
          ]
          [
            sp:object [
                sp:varName "service" ;
              ] ;
            sp:predicate sam:A ;
            sp:subject [
                sp:varName "abb" ;
              ] ;
          ]
          [
            a sp:Bind ;
            sp:expression [
                a sp:if ;
                sp:arg1 [
                    a sp:bound ;
                    sp:arg1 [
                        sp:varName "association" ;
                      ] ;
                  ] ;
                sp:arg2 "dotted" ;
                sp:arg3 [
                    a sp:if ;
                    sp:arg1 [
                        a sp:bound ;
                        sp:arg1 [
                            sp:varName "assignment" ;
                          ] ;
                      ] ;
                    sp:arg2 "dashed" ;
                    sp:arg3 "solid" ;
                  ] ;
              ] ;
            sp:variable [
                sp:varName "style" ;
              ] ;
          ]
        ) ;
    ] ;
  spin:constraint [
      a spl:Argument ;
      spl:predicate sp:arg1 ;
    ] ;
  spin:returnType xsd:string ;
  rdfs:label "get style" ;
  rdfs:subClassOf spin:Functions ;
.
